# Goコーディング規約

## 目次
- [フォーマット](#フォーマット)
- [命名規則](#命名規則)
- [パッケージ構成](#パッケージ構成)
- [エラー処理](#エラー処理)
- [コメント](#コメント)
- [ベストプラクティス](#ベストプラクティス)

## フォーマット

### インデント
- タブを使用する（スペースではなく）
- タブ幅は8スペース相当

### 行の長さ
- 特に制限はないが、100文字程度を目安にする
- 長い行は適切に改行する

### 空白行
- 関数間には空白行を入れる
- 論理的なセクション間には空白行を入れる

### gofmt
- コードは常に `gofmt` でフォーマットする
- コミット前に必ず `gofmt` を実行する

## 命名規則

### パッケージ名
- 小文字のみを使用
- 短く簡潔にする（例: `http`, `json`）
- 複数の単語を使用する場合はアンダースコアを使わない（例: `strconv`）

### 変数名
- キャメルケース（camelCase）を使用
- 短い変数名を好む（例: `i` for インデックス）
- 頭字語はすべて大文字または小文字にする（例: `HTTP`, `url`, `Id`は避ける）

### 定数
- キャメルケースを使用
- エクスポートする定数は大文字で始める

### インターフェース名
- キャメルケースを使用
- 単一のメソッドのインターフェースは「er」をつける（例: `Reader`, `Writer`）

### 構造体名
- キャメルケースを使用
- エクスポートする構造体は大文字で始める

## パッケージ構成

### ディレクトリ構造
- 機能ごとにパッケージを分ける
- `internal/` ディレクトリに外部に公開しないコードを配置
- `pkg/` ディレクトリに再利用可能なコードを配置

### インポート
- インポートはグループ化する
  1. 標準ライブラリ
  2. 外部ライブラリ
  3. プロジェクト内パッケージ
- 各グループの間に空行を入れる
- アルファベット順に並べる

### 循環依存
- パッケージ間の循環依存を避ける
- 必要に応じてインターフェースを活用

## エラー処理

### エラーチェック
- エラーは発生直後にチェックする
- エラーを無視しない（必要な場合はコメントで理由を説明する）

### エラー返却
- エラーはできるだけ具体的に返す
- `fmt.Errorf` でコンテキストを追加する
- カスタムエラータイプを適切に使用する

### エラーラッピング
- Go 1.13以降は `%w` を使ってエラーをラップする
- `errors.Is` や `errors.As` を使用してエラーをチェックする

## コメント

### 一般的なコメント
- エクスポートされる全ての識別子にはコメントを付ける
- コメントは完全な文で書き、ピリオドで終わる
- コメントは「何をするか」だけでなく「なぜするか」も説明する

### パッケージコメント
- 各パッケージには `package` 宣言の前にパッケージコメントを記述する
- パッケージの目的と使用方法を説明する

### GoDoc
- 公開APIは全て GoDoc 形式のコメントを記述する
- 例を含めると理解しやすくなる

## ベストプラクティス

### コード重複
- DRY（Don't Repeat Yourself）原則に従う
- 共通のコードは関数やパッケージに抽出する

### 並行処理
- ゴルーチンのリークを避ける
- 適切にチャネルを閉じる
- `sync.WaitGroup` を使って完了を待つ

### テスト
- 各パッケージには十分なテストを含める
- テーブル駆動テストを活用する
- ベンチマークテストを書いて性能を確認する

### 依存関係
- 依存関係は最小限に保つ
- vendorディレクトリまたはGo Modulesを使用する

### セキュリティ
- 入力値は常に検証する
- SQL インジェクションやコマンドインジェクションを防ぐ
- 機密情報をログに出力しない
```

このコーディング規約は、プロジェクトの一貫性を保ち、可読性を高め、バグを減らすのに役立ちます。
